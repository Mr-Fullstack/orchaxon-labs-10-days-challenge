const translations = {
    "pt": {
        "today": "Hoje",
        "hello": "Ol√°,",
        "visitante": "Visitante",
        "mood_title": "Como voc√™ est√° se sentindo?",
        "mood_happy": "Feliz",
        "mood_calm": "Calmo",
        "mood_tired": "Cansado",
        "mood_irritated": "Irritado",
        "mood_anxious": "Ansioso",
        "mood_sad": "Triste",
        "install_title": "Instalar App",
        "install_desc": "Acesse offline.",
        "install_btn": "Adicionar √† Tela Inicial",
        "tab_home": "In√≠cio",
        "tab_goals": "Metas",
        "tab_diary": "Di√°rio",
        "tab_activities": "Ativ.",
        "goals_title": "Minhas Metas",
        "goals_soon_title": "Em breve!",
        "goals_soon_desc": "Estamos preparando uma √°rea especial para voc√™ acompanhar seus objetivos.",
        "diary_title": "Di√°rio Emocional",
        "diary_history": "Hist√≥rico",
        "activities_title": "Atividades",
        "tool_intention_title": "Definir Inten√ß√£o",
        "tool_intention_desc": "Qual √© o seu foco principal?",
        "tool_gratitude_title": "Praticar Gratid√£o",
        "tool_gratitude_desc": "3 coisas boas de hoje.",
        "tool_soon_title": "Mais em breve",
        "tool_soon_desc": "Respirar, Meditar, Refletir...",
        "settings_title": "Configura√ß√µes",
        "settings_name_label": "SEU NOME",
        "settings_name_placeholder": "Digite seu nome",
        "settings_lang_label": "IDIOMA",
        "settings_appearance_label": "APAR√äNCIA",
        "settings_dark_mode": "Modo Escuro",
        "modal_mood_label": "Estou me sentindo",
        "modal_context_label": "Quer adicionar um contexto?",
        "modal_context_placeholder": "Ex: Tive uma reuni√£o produtiva...",
        "btn_save": "Salvar Registro",
        "btn_conclude": "Concluir",
        "modal_tool_placeholder_intention": "Ex: Manter a calma...",
        "modal_tool_placeholder_gratitude": "1. Caf√©\n2. Sol...",
        "empty_history": "Nenhum registro ainda.",
        "alert_saved": "Salvo com sucesso! ‚ú®",
        "settings_plan_label": "SEU PLANO",
        "plan_free": "Gratuito",
        "plan_pro": "Premium",
        "plan_upgrade": "Fa√ßa Upgrade",
        
        // AI Insights (Simulados)
        "ai_modal_title": "Insight do Aboyou üå±",
        "ai_thinking": "Analisando seus sentimentos...",
        "insight_happy": ["Que momento √≥timo! Tente 'ancorar' essa sensa√ß√£o: feche os olhos e sinta onde essa alegria vive no seu corpo.", "A felicidade √© contagiante. Que tal mandar uma mensagem para algu√©m que voc√™ ama agora?", "Aproveite essa energia para resolver aquela tarefa que estava parada."],
        "insight_calm": ["A calma √© um superpoder. Aproveite para ler um pouco ou apenas respirar fundo.", "Esse equil√≠brio √© precioso. Tente manter esse ritmo suave pelo resto do dia.", "√ìtimo momento para planejar sua semana com clareza."],
        "insight_tired": ["Seu corpo est√° pedindo uma pausa. Mesmo 5 minutos de olhos fechados j√° ajudam.", "N√£o se cobre tanto hoje. Feito √© melhor que perfeito quando estamos cansados.", "Hidrate-se e tente dormir 30 minutos mais cedo hoje."],
        "insight_irritated": ["A raiva √© uma energia de defesa. O que voc√™ sente que foi invadido?", "T√©cnica r√°pida: Solte os ombros, destrave o maxilar e respire fundo 3 vezes.", "Evite decis√µes importantes agora. Espere a poeira baixar."],
        "insight_anxious": ["Voc√™ est√° seguro agora. Olhe em volta e nomeie 3 objetos azuis para se aterrar.", "Inspire contando at√© 4, segure 4, solte em 4. Repita.", "A ansiedade mente sobre o futuro. Foque apenas no pr√≥ximo passo simples."],
        "insight_sad": ["Est√° tudo bem n√£o estar bem. Acolha esse sentimento sem julgamento.", "Escrever sobre o que d√≥i ajuda a tirar o peso do peito.", "Fa√ßa algo gentil por voc√™ hoje: um ch√° quente, um banho longo ou uma m√∫sica suave."],
        "home_daily_insight": "Dica do dia: Pequenos progressos ainda s√£o progressos."
    },
    "en": {
        "today": "Today",
        "hello": "Hello,",
        "visitante": "Guest",
        "mood_title": "How are you feeling?",
        "mood_happy": "Happy",
        "mood_calm": "Calm",
        "mood_tired": "Tired",
        "mood_irritated": "Angry",
        "mood_anxious": "Anxious",
        "mood_sad": "Sad",
        "install_title": "Install App",
        "install_desc": "Access offline.",
        "install_btn": "Add to Home Screen",
        "tab_home": "Home",
        "tab_goals": "Goals",
        "tab_diary": "Journal",
        "tab_activities": "Activ.",
        "goals_title": "My Goals",
        "goals_soon_title": "Coming Soon!",
        "goals_soon_desc": "We are preparing a special area for you to track your goals.",
        "diary_title": "Emotional Journal",
        "diary_history": "History",
        "activities_title": "Activities",
        "tool_intention_title": "Set Intention",
        "tool_intention_desc": "What is your main focus?",
        "tool_gratitude_title": "Practice Gratitude",
        "tool_gratitude_desc": "3 good things today.",
        "tool_soon_title": "More coming soon",
        "tool_soon_desc": "Breathe, Meditate, Reflect...",
        "settings_title": "Settings",
        "settings_name_label": "YOUR NAME",
        "settings_name_placeholder": "Type your name",
        "settings_lang_label": "LANGUAGE",
        "settings_appearance_label": "APPEARANCE",
        "settings_dark_mode": "Dark Mode",
        "modal_mood_label": "I am feeling",
        "modal_context_label": "Want to add context?",
        "modal_context_placeholder": "Ex: Had a productive meeting...",
        "btn_save": "Save Record",
        "btn_conclude": "Done",
        "modal_tool_placeholder_intention": "Ex: Stay calm...",
        "modal_tool_placeholder_gratitude": "1. Coffee\n2. Sun...",
        "empty_history": "No records yet.",
        "alert_saved": "Saved successfully! ‚ú®",
        "settings_plan_label": "YOUR PLAN",
        "plan_free": "Free Plan",
        "plan_pro": "Premium",
        "plan_upgrade": "Upgrade",

        "ai_modal_title": "Aboyou Insight üå±",
        "ai_thinking": "Analyzing your mood...",
        "insight_happy": ["Great moment! Try to 'anchor' this feeling: close your eyes and feel where joy lives in your body.", "Happiness is contagious. Text someone you love right now.", "Use this energy to tackle a pending task."],
        "insight_calm": ["Calm is a superpower. Take a moment to read or just breathe deeply.", "This balance is precious. Try to keep this gentle pace today.", "Great time to plan your week with clarity."],
        "insight_tired": ["Your body needs a break. Even 5 minutes with eyes closed helps.", "Don't push too hard. Done is better than perfect when tired.", "Drink water and try to sleep 30 mins earlier tonight."],
        "insight_irritated": ["Anger is defense energy. What boundary was crossed?", "Quick fix: Drop your shoulders, unclench your jaw, breathe deep 3 times.", "Avoid big decisions right now. Let the dust settle."],
        "insight_anxious": ["You are safe. Look around and name 3 blue objects to ground yourself.", "Inhale for 4, hold for 4, exhale for 4. Repeat.", "Anxiety lies about the future. Focus only on the next simple step."],
        "insight_sad": ["It's okay not to be okay. Embrace this feeling without judgment.", "Writing about what hurts helps lift the weight.", "Do something kind for yourself: hot tea, a long bath, or soft music."],
        "home_daily_insight": "Daily Tip: Small progress is still progress."
    },
    "es": {
        "today": "Hoy",
        "hello": "Hola,",
        "visitante": "Visitante",
        "mood_title": "¬øC√≥mo te sientes?",
        "mood_happy": "Feliz",
        "mood_calm": "Calmado",
        "mood_tired": "Cansado",
        "mood_irritated": "Enojado",
        "mood_anxious": "Ansioso",
        "mood_sad": "Triste",
        "install_title": "Instalar App",
        "install_desc": "Acceso sin conexi√≥n.",
        "install_btn": "A√±adir a Inicio",
        "tab_home": "Inicio",
        "tab_goals": "Metas",
        "tab_diary": "Diario",
        "tab_activities": "Activ.",
        "goals_title": "Mis Metas",
        "goals_soon_title": "¬°Pr√≥ximamente!",
        "goals_soon_desc": "Estamos preparando un √°rea especial para tus objetivos.",
        "diary_title": "Diario Emocional",
        "diary_history": "Historial",
        "activities_title": "Actividades",
        "tool_intention_title": "Definir Intenci√≥n",
        "tool_intention_desc": "¬øCu√°l es tu enfoque principal?",
        "tool_gratitude_title": "Practicar Gratitud",
        "tool_gratitude_desc": "3 cosas buenas de hoy.",
        "tool_soon_title": "M√°s pronto",
        "tool_soon_desc": "Respirar, Meditar, Reflexionar...",
        "settings_title": "Configuraci√≥n",
        "settings_name_label": "TU NOMBRE",
        "settings_name_placeholder": "Escribe tu nombre",
        "settings_lang_label": "IDIOMA",
        "settings_appearance_label": "APARIENCIA",
        "settings_dark_mode": "Modo Oscuro",
        "modal_mood_label": "Me siento",
        "modal_context_label": "¬øQuieres a√±adir contexto?",
        "modal_context_placeholder": "Ej: Tuve una reuni√≥n productiva...",
        "btn_save": "Guardar",
        "btn_conclude": "Concluir",
        "modal_tool_placeholder_intention": "Ej: Mantener la calma...",
        "modal_tool_placeholder_gratitude": "1. Caf√©\n2. Sol...",
        "empty_history": "Sin registros a√∫n.",
        "alert_saved": "¬°Guardado con √©xito! ‚ú®",
        "settings_plan_label": "TU PLAN",
        "plan_free": "Gratuito",
        "plan_pro": "Premium",
        "plan_upgrade": "Mejorar",

        "ai_modal_title": "Insight de Aboyou üå±",
        "ai_thinking": "Analizando sentimientos...",
        "insight_happy": ["¬°Qu√© buen momento! Intenta 'anclar' esta sensaci√≥n: cierra los ojos y si√©ntela.", "La felicidad se contagia. Env√≠a un mensaje a alguien que amas.", "Usa esta energ√≠a para resolver esa tarea pendiente."],
        "insight_calm": ["La calma es un superpoder. Aprovecha para leer o respirar hondo.", "Este equilibrio es precioso. Intenta mantener este ritmo suave.", "Buen momento para planificar tu semana con claridad."],
        "insight_tired": ["Tu cuerpo pide descanso. 5 minutos con los ojos cerrados ayudan.", "No te exijas tanto. Hecho es mejor que perfecto hoy.", "Hidr√°tate e intenta dormir 30 minutos antes."],
        "insight_irritated": ["La ira es defensa. ¬øQu√© l√≠mite se cruz√≥?", "R√°pido: Baja los hombros, relaja la mand√≠bula, respira 3 veces.", "Evita decisiones importantes ahora."],
        "insight_anxious": ["Est√°s a salvo. Mira alrededor y nombra 3 objetos azules.", "Inhala en 4, mant√©n 4, exhala en 4. Repite.", "La ansiedad miente sobre el futuro. Enf√≥cate en el paso actual."],
        "insight_sad": ["Est√° bien no estar bien. Acepta el sentimiento.", "Escribir sobre lo que duele ayuda.", "Haz algo amable por ti: t√© caliente, ba√±o largo o m√∫sica suave."],
        "home_daily_insight": "Consejo: Peque√±os progresos siguen siendo progresos."
    }
};

let currentLang = localStorage.getItem('aboyou_lang') || 'pt';

function setLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('aboyou_lang', lang);
    
    // Atualiza textos
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang][key]) {
            if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                el.placeholder = translations[lang][key];
            } else {
                el.innerText = translations[lang][key];
            }
        }
    });

    // Atualiza bot√µes de idioma (Visual)
    document.querySelectorAll('.lang-btn').forEach(btn => {
        if(btn.dataset.lang === lang) {
            btn.classList.add('bg-primary-100', 'text-primary-700', 'border-primary-200');
            btn.classList.remove('bg-slate-50', 'text-slate-500', 'border-slate-100');
        } else {
            btn.classList.remove('bg-primary-100', 'text-primary-700', 'border-primary-200');
            btn.classList.add('bg-slate-50', 'text-slate-500', 'border-slate-100');
        }
    });

    // Atualiza Data (Locale)
    updateDateDisplay();
    // 4. ATUALIZA√á√ÉO DIN√ÇMICA (O Fix do Insight) üëá
    // Verifica se as fun√ß√µes do app.js j√° existem e as chama para retraduzir
    if (typeof updateHomeInsight === 'function') updateHomeInsight(); 
    if (typeof renderHistory === 'function') renderHistory(); // Atualiza os t√≠tulos do hist√≥rico tamb√©m
}

function updateDateDisplay() {
    const locales = { 'pt': 'pt-BR', 'en': 'en-US', 'es': 'es-ES' };
    const date = new Date();
    document.getElementById('date-display').innerText = date.toLocaleDateString(locales[currentLang], { weekday: 'long', day: 'numeric', month: 'short' });
}